<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Unit testing hooks · Rest Hooks</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Hooks allow you to pull complex behaviors out of your components into succinct,"/><meta name="docsearch:version" content="5.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Unit testing hooks · Rest Hooks"/><meta property="og:type" content="website"/><meta property="og:url" content="https://resthooks.io/"/><meta property="og:description" content="Hooks allow you to pull complex behaviors out of your components into succinct,"/><meta property="og:image" content="https://resthooks.io/img/rest_hooks_logo.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://resthooks.io/img/rest_hooks_logo.png"/><link rel="shortcut icon" href="/img/favicon/favicon.ico"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="https://resthooks.io/blog/atom.xml" title="Rest Hooks Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="https://resthooks.io/blog/feed.xml" title="Rest Hooks Blog RSS Feed"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-138752992-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="preload" href="/font/Graphik-Regular-Web.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/font/Graphik-RegularItalic-Web.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/font/Graphik-Semibold-Web.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><link rel="preload" href="/font/Graphik-SemiboldItalic-Web.woff2" as="font" type="font/woff2" crossorigin="anonymous"/><script type="text/javascript" src="/scripts/sidebarScroll.js"></script><script type="text/javascript" src="/scripts/codeblock.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/rest_hooks_logo.svg" alt="Rest Hooks"/><h2 class="headerTitleWithLogo">Rest Hooks</h2></a><a href="/versions"><h3>5.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/getting-started/installation" target="_self">Getting Started</a></li><li class="siteNavGroupActive"><a href="/docs/api/README" target="_self">API</a></li><li class="siteNavGroupActive"><a href="/docs/guides/resource-types" target="_self">Resource Definitions</a></li><li class=""><a href="/blog/" target="_self">Blog</a></li><li class=""><a href="https://www.github.com/coinbase/rest-hooks" target="_self">Github</a></li><li class=""><a href="https://github.com/Rest-Hooks/todo-example" target="_blank">🎮 Demo</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Testing</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/getting-started/installation">Installation</a></li><li class="navListItem"><a class="navItem" href="/docs/getting-started/usage">Usage</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/loading-state">Handling loading state</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/network-errors">Dealing with network errors</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/fetch-multiple">Fetching multiple resources at once</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Resource Definitions<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/guides/resource-types">Resource types</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Network Interface</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/url">URL Patterns</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/extending-endpoints">Custom endpoints</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/rest-types">Typing REST Endpoints</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/pagination">Pagination</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/auth">Authentication</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/network-transform">Transforming data on fetch</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/mocking-unfinished">Mocking unfinished endpoints</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Entity Interface</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/computed-properties">Computed Properties</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/multi-pk">Multi-column primary key</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Performance Optimizations</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/nested-response">Nesting related resources (server-side join)</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/rpc">Capturing Mutation Side-Effects</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Advanced<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Resource Definitions</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/custom-networking">Custom networking library</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/resource-lifetime">Custom cache lifetime</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/binary-fetches">Fetching Media</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Components</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/infinite-scrolling-pagination">Infinite Scrolling</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Testing</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/debugging">Debugging</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/storybook">Mocking data for Storybook</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/guides/unit-testing-hooks">Unit testing hooks</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/unit-testing-components">Unit testing components</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Performance</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/render-as-you-fetch">Render as you Fetch</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/immediate-updates">Immediate Mutation Updates</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/optimistic-updates">Optimistic Updates</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/abort">Aborting Fetch</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Integrations</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/redux">Redux integration</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Legacy</h4><ul><li class="navListItem"><a class="navItem" href="/docs/guides/class-components">Usage with class components</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/no-suspense">Usage without Suspense</a></li><li class="navListItem"><a class="navItem" href="/docs/guides/legacy-browser">Legacy browser support</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/api/README">API Reference</a></li><li class="navListItem"><a class="navItem" href="/docs/api/types">Types</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Core Hooks</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/useresource">useResource()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useFetcher">useFetcher()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useCache">useCache()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useSubscription">useSubscription()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useRetrieve">useRetrieve()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useInvalidator">useInvalidator()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useResetter">useResetter()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useMeta">useMeta()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useError">useError()</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Extra Hooks</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/useDebounce">useDebounce()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useCancelling">useCancelling()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/useLoading">useLoading()</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Interface Definitions</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/Endpoint">Endpoint</a></li><li class="navListItem"><a class="navItem" href="/docs/api/resource">Resource</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Index">Index</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Schemas</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/schema">Quick Start</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Entity">Entity</a></li><li class="navListItem"><a class="navItem" href="/docs/api/SimpleRecord">SimpleRecord</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Object">Object</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Array">Array</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Union">Union</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Values">Values</a></li><li class="navListItem"><a class="navItem" href="/docs/api/Delete">Delete</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Components</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/CacheProvider">&lt;CacheProvider /&gt;</a></li><li class="navListItem"><a class="navItem" href="/docs/api/ExternalCacheProvider">&lt;ExternalCacheProvider /&gt;</a></li><li class="navListItem"><a class="navItem" href="/docs/api/NetworkErrorBoundary">&lt;NetworkErrorBoundary /&gt;</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Managers</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/Manager">Manager</a></li><li class="navListItem"><a class="navItem" href="/docs/api/NetworkManager">NetworkManager</a></li><li class="navListItem"><a class="navItem" href="/docs/api/SubscriptionManager">SubscriptionManager</a></li><li class="navListItem"><a class="navItem" href="/docs/api/PollingSubscription">PollingSubscription</a></li><li class="navListItem"><a class="navItem" href="/docs/api/DevToolsManager">DevToolsManager</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Testing</h4><ul><li class="navListItem"><a class="navItem" href="/docs/api/MockResolver">&lt;MockResolver /&gt;</a></li><li class="navListItem"><a class="navItem" href="/docs/api/makeRenderRestHook">makeRenderRestHook()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/makeCacheProvider">makeCacheProvider()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/makeExternalCacheProvider">makeExternalCacheProvider()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/mockInitialState">mockInitialState()</a></li><li class="navListItem"><a class="navItem" href="/docs/api/MockProvider">&lt;MockProvider /&gt;</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Upgrade Guide<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/upgrade/upgrading-to-5">Upgrading from 4 to 5</a></li><li class="navListItem"><a class="navItem" href="/docs/upgrade/upgrading-test-to-three">Upgrading @rest-hooks/test to 3</a></li><li class="navListItem"><a class="navItem" href="/docs/upgrade/upgrading-test-to-four">Upgrading @rest-hooks/test to 4</a></li><li class="navListItem"><a class="navItem" href="/docs/upgrade/upgrading-test-to-six">Upgrading @rest-hooks/test to 6</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/coinbase/rest-hooks/edit/master/docs/guides/unit-testing-hooks.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Unit testing hooks</h1></header><article><div><span><p>Hooks allow you to pull complex behaviors out of your components into succinct,
composable functions. This makes testing component behavior potentially much
easier. But how does this work if you want to use hooks from <code>rest-hooks</code>?</p>
<p>We have provided some simple utilities to reduce boilerplate for unit tests
that are wrappers around <a href="https://github.com/testing-library/react-hooks-testing-library">@testing-library/react-hooks</a>'s <a href="https://react-hooks-testing-library.com/reference/api#renderhook-options">renderHook()</a>.</p>
<p>We want a <a href="../api/makeRenderRestHook#renderresthook">renderRestHook()</a> function that renders in the context of both
a <code>Provider</code> and <code>Suspense</code> boundary.</p>
<p>To support both providers, you must choose among two provider-generators to
send as args to the <a href="../api/makeRenderRestHook#renderresthook">renderRestHook()</a> generator.</p>
<p>These will generally be done during test setup. It's important to call cleanup
upon test completion.</p>
<blockquote>
<p>Note:</p>
<p><code>renderRestHook()</code> creates a Provider context with new manager instances. This means each call
to <code>renderRestHook()</code> will result in a completely fresh cache state as well as manager state.</p>
</blockquote>
<h3><a class="anchor" aria-hidden="true" id="polyfill-fetch-in-node"></a><a href="#polyfill-fetch-in-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Polyfill fetch in node</h3>
<p>Node doesn't come with fetch out of the box, so we need to be sure to polyfill it.</p>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-241-tab-242" class="nav-link active" data-group="group_241" data-tab="tab-group-241-content-242">yarn</div><div id="tab-group-241-tab-243" class="nav-link" data-group="group_241" data-tab="tab-group-241-content-243">npm</div></div><div class="tab-content"><div id="tab-group-241-content-242" class="tab-pane active" data-group="group_241" tabindex="-1"><div><span><pre><code class="hljs css language-bash"><span class="token function">yarn</span> <span class="token function">add</span> --dev whatwg-fetch<br /></code></pre>
</span></div></div><div id="tab-group-241-content-243" class="tab-pane" data-group="group_241" tabindex="-1"><div><span><pre><code class="hljs css language-bash"><span class="token function">npm</span> <span class="token function">install</span> --save-dev whatwg-fetch<br /></code></pre>
</span></div></div></div></div>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-244-tab-245" class="nav-link active" data-group="group_244" data-tab="tab-group-244-content-245">jest</div></div><div class="tab-content"><div id="tab-group-244-content-245" class="tab-pane active" data-group="group_244" tabindex="-1"><div><span><pre><code class="hljs css language-js"><span class="token comment">// jest.config.js</span><br />module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><br />  <span class="token comment">// other things</span><br />  setupFiles<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./testSetup.js'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br /><span class="token punctuation">}</span><span class="token punctuation">;</span><br /></code></pre>
<pre><code class="hljs css language-js"><span class="token comment">// testSetup.js</span><br /><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'whatwg-fetch'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /></code></pre>
</span></div></div></div></div>
<h3><a class="anchor" aria-hidden="true" id="example"></a><a href="#example" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Example:</h3>
<div class="tabs"><div class="nav-tabs"><div id="tab-group-246-tab-247" class="nav-link active" data-group="group_246" data-tab="tab-group-246-content-247">CacheProvider</div><div id="tab-group-246-tab-248" class="nav-link" data-group="group_246" data-tab="tab-group-246-content-248">ExternalCacheProvider</div></div><div class="tab-content"><div id="tab-group-246-content-247" class="tab-pane active" data-group="group_246" tabindex="-1"><div><span><pre><code class="hljs css language-typescript"><span class="token keyword">import</span> nock <span class="token keyword">from</span> <span class="token string">'nock'</span><span class="token punctuation">;</span><br /><span class="token keyword">import</span> <span class="token punctuation">{</span> makeRenderRestHook<span class="token punctuation">,</span> makeCacheProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@rest-hooks/test'</span><span class="token punctuation">;</span><br /><br /><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'useResource()'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />  <span class="token keyword">let</span> renderRestHook<span class="token operator">:</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> makeRenderRestHook<span class="token operator">></span><span class="token punctuation">;</span><br /><br />  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">defaultReplyHeaders</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br />        <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span><br />        <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span><br />      <span class="token punctuation">}</span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/article/0</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    renderRestHook <span class="token operator">=</span> <span class="token function">makeRenderRestHook</span><span class="token punctuation">(</span>makeCacheProvider<span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    nock<span class="token punctuation">.</span><span class="token function">cleanAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should throw errors on bad network'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    <span class="token keyword">const</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> waitForNextUpdate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">renderRestHook</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />      <span class="token keyword">return</span> <span class="token function">useResource</span><span class="token punctuation">(</span>ArticleResource<span class="token punctuation">.</span><span class="token function">detail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br />        title<span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span><br />      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token keyword">await</span> <span class="token function">waitForNextUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeDefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>error <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /></code></pre>
</span></div></div><div id="tab-group-246-content-248" class="tab-pane" data-group="group_246" tabindex="-1"><div><span><pre><code class="hljs css language-typescript"><span class="token keyword">import</span> nock <span class="token keyword">from</span> <span class="token string">'nock'</span><span class="token punctuation">;</span><br /><span class="token keyword">import</span> <span class="token punctuation">{</span> makeRenderRestHook<span class="token punctuation">,</span> makeExternalCacheProvider <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@rest-hooks/test'</span><span class="token punctuation">;</span><br /><br /><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'useResource()'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />  <span class="token keyword">let</span> renderRestHook<span class="token operator">:</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> makeRenderRestHook<span class="token operator">></span><span class="token punctuation">;</span><br /><br />  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    <span class="token function">nock</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">defaultReplyHeaders</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br />        <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'*'</span><span class="token punctuation">,</span><br />        <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span><span class="token punctuation">,</span><br />      <span class="token punctuation">}</span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">options</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">.*</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/article/0</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><br />      <span class="token punctuation">.</span><span class="token function">reply</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    renderRestHook <span class="token operator">=</span> <span class="token function">makeRenderRestHook</span><span class="token punctuation">(</span>makeExternalCacheProvider<span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    nock<span class="token punctuation">.</span><span class="token function">cleanAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><br />  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should throw errors on bad network'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />    <span class="token keyword">const</span> <span class="token punctuation">{</span> result<span class="token punctuation">,</span> waitForNextUpdate <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">renderRestHook</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br />      <span class="token keyword">return</span> <span class="token function">useResource</span><span class="token punctuation">(</span>ArticleResource<span class="token punctuation">.</span><span class="token function">detail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><br />        title<span class="token operator">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span><br />      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>current<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token keyword">await</span> <span class="token function">waitForNextUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>error<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeDefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>error <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">403</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br />  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br /></code></pre>
</span></div></div></div></div>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/guides/storybook"><span class="arrow-prev">← </span><span>Mocking data for Storybook</span></a><a class="docs-next button" href="/docs/guides/unit-testing-components"><span>Unit testing components</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/rest_hooks_logo.svg" alt="Rest Hooks" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/getting-started/installation">Getting Started</a><a href="/docs/guides/resource-types">Resource Definitions</a><a href="/docs/api/README">API Reference</a></div><div><h5>Community</h5><a href="/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/rest-hooks" target="_blank" rel="noreferrer noopener">Stack Overflow</a></div><div><h5>More</h5><a href="https://github.com/coinbase/rest-hooks">GitHub</a><a class="github-button" href="https://github.com/coinbase/rest-hooks" data-icon="octicon-star" data-count-href="/coinbase/rest-hooks/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a><a href="https://discord.gg/35nb8Mz"><img src="https://img.shields.io/discord/768254430381735967.svg?style=flat-square&amp;colorB=758ED3" alt="Chat"/></a></div></section><section class="copyright">Copyright © 2021 Coinbase<br/>Some icons copyright Font Awesome and Noun Project (Hassan ali, ProSymbols)</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '52e661c10738fd114bcf68d537358c16',
                indexName: 'coinbase-rest-hooks',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:5.0"]}
              });
            </script></body></html>